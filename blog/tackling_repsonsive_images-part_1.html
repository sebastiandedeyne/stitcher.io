<html>
    <head>
        
            <title>Stitcher 1.0</title>
            <meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="Static websites with PHP, YAML, MarkDown, JSON and Smarty/Twig">
            <style>body{padding:0;margin:0;position:relative;background:#f5f5f5;font-family:"Helvetica Neue",Helvetica,sans-serif;font-size:18px}.wrapper{width:960px;margin:0 auto}.vwrapper{margin-top:2em}img{display:block;max-width:25%}a{color:#128d9e}h1{color:#128d9e}h2{margin-top:40px}h3{margin-top:1.6em;margin-bottom:.7em}h4{margin-top:2.5em;margin-bottom:1em}p{line-height:1.7em}li{margin:10px 0}li>code,p>code{display:inline-block;border-bottom:1px solid #ff8719;cursor:pointer;padding-left:2px;padding-right:2px;line-height:1em;padding-bottom:2px}code{background:#fff;font-family:Monaco,monospace}pre>code{display:block;border-left:5px solid #ff8719;padding:1.3em 30px;font-size:.8em;line-height:1.5em;cursor:pointer;margin-left:-20px;overflow-x:scroll}.button{cursor:pointer;color:#fff;border:1px solid #fff;padding:10px;display:inline-block;text-decoration:none;margin-right:10px}.button:last-child{margin-right:0}.button-link{margin-right:10px;color:#fff;font-weight:100}header{display:block;background:#128d9e;color:#fff}header nav>a{color:inherit;display:inline-block;text-decoration:none;padding:15px 20px}header nav>a:first-child{padding-left:0}.stitcher{color:inherit;font-weight:100;font-style:italic}.next{display:block;float:right}.prev{display:block;float:left}footer{margin-top:40px;background:#484848;color:#fff;padding:30px 0}footer:after{clear:both;display:block;content:' '}footer a{color:inherit}.blog{width:90%;background:#fff;margin-top:4em;padding-bottom:2em}.blog>h1{padding:1.5em 4% .5em}.blog>h2,.blog>h3,.blog>h4,.blog>h5{padding:0 5%}.blog img+h1{padding-top:.75em}.blog>p{padding-left:5%;padding-right:5%}.blog>pre>code{margin-left:0}.blog>img{display:block;width:100%;max-width:100%}.image--header{display:block}</style>
        
    </head>
    <body>
        
            <a href="https://github.com/brendt/stitcher" target="_blank" rel="nofollow noopener"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/652c5b9acfaddf3a9c326fa6bde407b87f7be0f4/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6f72616e67655f6666373630302e706e67" alt="Fork Stitcher on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png"></a>
        
        
            
                <header>
                    <nav class="wrapper">
                        <a href="/" class="stitcher">Stitcher</a>
                        <a href="/guide">Guide</a>
                        <a href="/blog">Blog</a>
                    </nav>
                </header>
            

            
                            

            <div class="wrapper">
                
    <article class="blog">
                    <img src="/img/html.png" srcset="/img/html-3360.png 3360w,/img/html-2375.png 2375w,/img/html-1680.png 1680w,/img/html-1187.png 1187w,/img/html-840.png 840w" sizes="50vw" alt="">
                <h1>Tackling repsonsive images - part 1</h1>

        <p>One of the main goals when I started with Stitcher was heavily optimized images. Looking at the <a href="http://httparchive.org/trends.php">HTTP Archive</a> stats, it's clear we're doing something wrong. Luckily, the <a href="http://responsiveimages.org/">Responsive images spec</a> has been made by a lot of smart people to counter the image problem. My goal was to implement this spec in Stitcher in a way that was easy enough for developers to use it to its full extent. We're not completely there yet, but we're close. In this blogpost I want to talk about the challenges I faced creating this library. And if you're more into code then into reading a blog post, <a href="https://github.com/brendt/responsive-images">here you go</a>.</p>
<p>To be clear: the goal of the responsive images spec is to reduce bandwith used when downloading images. Images nowadays require so much bandwith. When you think about it, it's insane to load an image which is 2000 pixels wide, when your the image on screen is only 500 pixels wide. That's the issue the spec addresses, and that's the issue I wanted to solve in Stitcher.</p>
<p>So I want one image to go in, x-amount of the same image with varying sizes coming out, and let the browser decide which image is the best to load. How could I downscale that source image? That was the most important question I wanted answered. All other problems like accessebility in templates and how to expose the generated image files, were concerns of Stitcher itself.</p>
<p>My first take on downscaling images was the following:</p>
<p>Take the source image and a set of configuration parameters. These parameters would decide the maximum amount of image variantions and the minimum width of the image. Eg. I want a maximum of ten images, with the smallest image being 300 pixels wide. Now the algorithm would loop a maximum of 10 times, always creating an image which is 10% smaller in width than the previous one.</p>
<p>You might already see this is not the optimal approach. After all: we're trying to reduce bandwith used when loading images. There is no guarantee an image which is downscaled 10%, is also reduced in size. Much depends on which image codecs are used, and what's in the image itself. But by using this approach early on, I was able to implement this &quot;image factory&quot; with Stitcher. Next I would be working on optimizing the algorithm, but for the time being I could tackle the Stitcher integration.</p>
<h2>Linking with Stitcher</h2>
<p>Letting Stitcher know about responsive images was both easy and difficult at the same time. The basic framework was already there. So I could easily create an image provider which used the responsive factory, and returned an array representation of the image. The template syntax looks like this:</p>
<pre><code class="language-html">&lt;img src="{$image.src}" srcset="{$image.srcset}" sizes="{$image.sizes}" /&gt;</code></pre>
<p>Unfortunately, there is no way to automate the sizes part, unless you start crawling all CSS and basically implement a browser engine in PHP. My solution for this part is pre-defined sets of sizes. That's still a work in progress though, I'm not sure yet how to make it easy enough to use. For now, I'm just manually specifying sizes when writing template code.</p>
<p>But the tricky part wasn't the sizes, neither the srcset. It was handling paths and URLs. I've noticed this throughout the whole Stitcher framework: creating the right paths and URLs (correct amount of slashes, correct root directory etc.) is actually quite the pain to manage. I'm convinced by now I need some kind of helper which always renders the correct paths and URLs. It's on my todo list.</p>
<p>That's it for this blogpost, next up I'll be writing about optimizing the image algorithm.</p>
    </article>

            </div>

            <footer>
                
    <div class="wrapper">
        <a class="prev" href="/blog">Back</a>
                    <a class="next" href="/blog/tackling_repsonsive_images-part_2">Next: Tackling repsonsive images - part 2</a>
            </div>

            </footer>

            
    <script>document.addEventListener('DOMContentLoaded',codeClick);function codeClick(){var codeBlocks=document.querySelectorAll('code');for(var codeBlock of codeBlocks){codeBlock.addEventListener('click',function(){var range=document.createRange();range.selectNode(this);window.getSelection().addRange(range);});}}</script>

        
    </body>
</html>
